%FIR Filter
#include "Configuration1cfg.h" #include "dsk6713.h" #include"dsk6713_aic23.h"
/*float b[]={-0.0157524150924022,-0.0238685132826490,- 0.0181758635681563,1.02306744372008e-17, .0214805660350939,
0.0334159185957086, 0.0262540251540036,	-1.02306744372008e-17,	-
0.0337551751980046, -0.0556931976595143,	-0.0472572452772064,
1.02306744372008e-17,0.0787620754620107,	0.167079592978543,
0.236286226386032, 0.262448010933082, 0.236286226386032,
0.167079592978543,  0.0787620754620107,	1.02306744372008e-17, -
0.0472572452772064,	-0.0556931976595143,	-0.0337551751980046,	-
1.02306744372008e-17,	0.0262540251540036,	0.0334159185957086,
0.0214805660350939,	1.02306744372008e-17,	-0.0181758635681563,-

 
0.0238685132826490,-0.0157524150924022};*/\

float b[]={-0.0089819,-0.017782,-0.02502,-0.029339,-0.029569,-0.024895,- 0.01497,5.3894e-
018,0.019247,0.041491,0.065053,0.088016,0.10842,0.12447,0.13473,0.13825,0.13473,0.124
47,0.10842,0.088016,0.065053,0.041491,0.019247,5.3894e-018,-0.01497,-0.024895,-
0.029569,-0.029339,-0.02502,-0.017782,-0.0089819};

/*float b[]={.0219418373499807,	0.0131942631153908,	-4.27515006108374e-17,
-0.0169640525769310,	-0.0365697289166346,	-0.0573367841256520,	-
0.0775761099093182,	-0.0955613068760867,	-0.109709186749904, -	
0.118748368038517, 0.852993879448159, -0.118748368038517, -0.109709186749904, -
0.0955613068760867,	-0.0775761099093182,	-0.0573367841256520,	-
0.0365697289166346,	-0.0169640525769310,	-4.27515006108374e-	
17,0.0131942631153908,	0.0219418373499807};*/\		
static short in_buffer[100];			

DSK6713_AIC23_Config config={\

0x0017, /* 0 DSK6713_AIC23_LEFTINVOL Leftline input channel volume*/\ 0x0017, /* 1 DSK6713_AIC23_RIGHTINVOL Rightline input channel volume*/\
0x00d8, /* 2 DSK6713_AIC23_LEFTHPVOL LEFT CHANNEL HEADPHONE volume*/\
0x00d8, /* 3 DSK6713_AIC23_RIGHTHPVOL Right Channel Headphone Volume*/\ 0x0011, /*4 DSK6713_AIC23_ANAPATH Analog audio path control*/\
0x0000, /*5 DSK6713_AIC23_DIGPATH Digital audio path control*/\ 0x0000, /*6 DSK6713_AIC23_POWERDOWN Powerdowncontrol*/\ 0x0043, /*7 DSK6713_AIC23_DIGIF digital audio interface format*/\ 0x0081, /*8 DSK6713_AIC23_SAMPLERATE sampleratecontrol*/\ 0x0001 /* 9DSK6713_AIC23_DIGACT Digital Interface Activation*/\};


void main(){ DSK6713_AIC23_CodecHandle hCodec; Uint32 l_input,r_input,l_output,r_output; DSK6713_init();
hCodec=DSK6713_AIC23_openCodec(0,&config); DSK6713_AIC23_setFreq(hCodec,1);
while(1){ while(!DSK6713_AIC23_read(hCodec,&l_input)); while(!DSK6713_AIC23_read(hCodec,&r_input)); l_output = (Int16)FIR_FILTER(&b,l_input); r_output = l_output; while(!DSK6713_AIC23_write(hCodec,l_output)); while(!DSK6713_AIC23_write(hCodec,r_output));
}
DSK6713_AIC23_closeCodec(hCodec);
}
signedint FIR_FILTER(float *h,signedint x)
{
inti=0;

 
signed long output =0; in_buffer[0] = x; for(i=30;i>0;i--)
in_buffer[i] = in_buffer[i-1]; for(i=0;i<32;i++)
output = output+ h[i]*in_buffer[i]; return(output);
}
